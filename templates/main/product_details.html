{% extends 'base.html' %}
{% load static %}
{% block page-title %}
    <title>{{ product.name }}</title>
{% endblock %}
{% block product_details %}
    <nav class="subcategory_menu navbar navbar-expand-lg bg-body-tertiary">
        <div class="container-fluid">
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0 w-100 justify-content-between">
                    <li class="btn-secondary nav-link dropdown-toggle"
                        data-bs-toggle="dropdown"
                        data-bs-auto-close="outside"
                        aria-expanded="false" style="color: #1A4582">

                        КАТАЛОГ
                    </li>

                    <ul class="dropdown-menu " style="width: 300px">
                        <li class="accordion dropdown-item accordion-flush" id="catalogaccordion">
                            {% for cat in allcategory %}

                                <div class="accordion-item">
                                    <h2 class="accordion-header">
                                        <button class="accordion-button collapsed" type="button"
                                                data-bs-toggle="collapse"
                                                data-bs-target="#section-{{ forloop.counter0 }}"
                                                aria-expanded="false"
                                                aria-controls="section-{{ forloop.counter0 }}"
                                                style="color: #1A4582; background-color: #E6E6E6;">
                                            {{ cat }}
                                        </button>

                                    </h2>
                                    {% for subcat in allsubcategory %}
                                        {% if subcat.category == cat %}
                                            <div id="section-{{ forloop.parentloop.counter0 }}"
                                                 class="accordion-collapse collapse"
                                                 aria-labelledby="headingOne" data-bs-parent="#catalogaccordion">
                                                <div class="accordion-body">
                                                    <a class="dropdown-item" style="color: #1A4582"
                                                       href="{% url 'subcategory' category=cat subcategory=subcat %}">{{ subcat }}</a>

                                                </div>
                                            </div>
                                        {% endif %}
                                    {% endfor %}
                                </div>
                            {% endfor %}
                            {##}
                        </li>
                        {##}
                        {##}
                    </ul>
                </ul>
            </div>
        </div>
    </nav>
    {% if product %}
        <div id="product_details_category" class="container px-0 py-3 d-table-row collapse w-100">
            <div class="category_line p-0 d-table-cell h-100 w-50"></div>
            <span class="fs-2 px-5 d-table-cell text-nowrap category_line_title"
                  style="font-family: 'Gotham Pro Medium',sans-serif;
                color: #1A4582;
            ">{% if product.subcategory %}{{ product.subcategory }} {% else%} {{ product.category }}{% endif %} </span>
            <div class="category_line p-0 d-table-cell h-100 w-100"></div>
        </div>

        {#        <section class="main-section" id="service">#}
        {#            <div class="container">#}
        {#                <h2>{{ product.name }}</h2>#}
        {#            </div>#}
        {#        </section>#}

        <div class="row my-4">
            <div class="col-lg-3 text-right wow fadeInUp delay-02s">
                <a href="{{ product.photo_url }}" class="w-100">
                    <img  class="w-100" src="{{ product.photo_url }}" alt="{{ product.name }}" style="object-fit: contain; max-height: 200px">
                </a>
            </div>
            <div class="col-lg-9 featured-box-col2 wow fadeInRight delay-02s">
                <h1
                        style="   overflow: hidden;
                                                       display: -webkit-box;
                                                       -webkit-line-clamp: 2; /* number of lines to show */
                                                               line-clamp: 2;
                                                       -webkit-box-orient: vertical;"

                ><strong>{{ product.name }}</strong></h1>
                <br>
                <div class="container d-flex w-100 product-description">
                    <div class="w-75 me-5">
                        <h4>{{ product.description }}</h4>
                    </div>

                    <div class="d-flex flex-column justify-content-around">
                        <h2 class="w-100 text-center align-self-center fw-bold fs-1 price">{{ product.packprices.first.price }}
                            р.</h2>
                        <button type="submit" id="submit_btn" class="btn btn-success details_to_cart_btn fs-3 add-to-cart-btn"
                                data-id="{{ product.vendor_code }}"
                                data-name="{{ product.name }}"
{#                                data-price="{{ product.packpricesprice }}"#}
                                data-weight="{{ product.packprices.first.id }}"
                        >
                            В корзину
                        </button>
                        <div id="cart-wrap-product-details" class="text-center justify-item-end cart-qty-wrapper mb-1 "
                             data-id="{{ product.vendor_code }}">
                            <button class="cart-minus to_cart_button fs-4 px-2"
                                    data-id="{{ product.vendor_code }}"
                                    data-weight="{{ packprices.first.id }}"> -
                            </button>
                            <i class="bi bi-basket"></i>
                            <span
                                    class="cart-qty fs-4 px-2"
                                    data-id="{{ product.vendor_code }}"
                                    data-weight=""
                            >0</span>
                            <button class="cart-plus  to_cart_button fs-4 px-2"
                                    data-id="{{ product.vendor_code }}"
                                    data-name="{{ product.name }}"
{#                                    data-price="{{ product.price }}"#}
                                    data-weight="{{ product.packprices.first.id }}"
                            >+
                            </button>

                        </div>

                    </div>
                </div>
                {% if product.packprices.all|length > 1%}

                    <div class="w-25 d-flex text-center justify-content-around"
                         aria-label="{{ product.name }}">
                        {% for weight in product.packprices.all %}
                            <button type="button"
                                    data-id="{{ product.vendor_code }}plus{{ weight.id }}"
                                    data-price="{{ weight.price }}"
                                    class="btn btn-secondary weight-select-product-details-button"
                                    style="font-size: 70%; {% if forloop.first %} background-color: pink {% else %} background-color: gray {%endif%}"
                            >{{ weight.weight }}</button>

                        {% endfor %}


                    </div>
                {% endif %}


            </div>

        </div>
    {% endif %}
{% endblock %}